(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e53f7a5"],{"06c5":function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));e("a630"),e("fb6a"),e("b0c0"),e("d3b7"),e("25f0"),e("3ca3");function a(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,a=new Array(n);e<n;e++)a[e]=t[e];return a}function r(t,n){if(t){if("string"===typeof t)return a(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?a(t,n):void 0}}},"0f6a":function(t,n,e){"use strict";(function(t){var a,r=e("3835"),i=e("53ca");"object"===Object(i["a"])(t)&&a?a=t.exports:"undefined"!==typeof window&&(a=window["eviltransform"]={});var o=6378137;function c(t,n){return n<72.004||n>137.8347||(t<.8293||t>55.8271)}function l(t,n){var e=t*n,a=Math.sqrt(Math.abs(t)),r=t*Math.PI,i=n*Math.PI,o=20*Math.sin(6*r)+20*Math.sin(2*r),c=o,l=o;return c+=20*Math.sin(i)+40*Math.sin(i/3),l+=20*Math.sin(r)+40*Math.sin(r/3),c+=160*Math.sin(i/12)+320*Math.sin(i/30),l+=150*Math.sin(r/12)+300*Math.sin(r/30),c*=2/3,l*=2/3,c+=2*t-100+3*n+.2*n*n+.1*e+.2*a,l+=300+t+2*n+.1*t*t+.1*e+.1*a,{lat:c,lng:l}}function s(t,n){var e=.006693421622965943,a=l(n-105,t-35),r=t/180*Math.PI,i=Math.sin(r);i=1-e*i*i;var c=Math.sqrt(i);return a.lat=180*a.lat/(o*(1-e)/(i*c)*Math.PI),a.lng=180*a.lng/(o/c*Math.cos(r)*Math.PI),a}function u(t,n){if(c(t,n))return{lat:t,lng:n};var e=s(t,n);return{lat:t+e.lat,lng:n+e.lng}}function h(t,n){if(c(t,n))return{lat:t,lng:n};var e=s(t,n);return{lat:t-e.lat,lng:n-e.lng}}function f(t,n){for(var e=t,a=n,r=e,i=a,o=1e-6,c=0;c<30;c++){r=e,i=a;var l=u(e,a);if(e-=t-l.lat,a-=n-l.lng,Math.max(Math.abs(r-e),Math.abs(i-a))<o)break}return{lat:e,lng:a}}function d(t,n,e,a){var r=Math.PI/180,i=t*r,c=e*r,l=Math.cos(i)*Math.cos(c)*Math.cos((n-a)*r),s=Math.sin(i)*Math.sin(c),u=l+s;u>1&&(u=1),u<-1&&(u=-1);var h=Math.acos(u),f=h*o;return f}function p(t,n){if(c(t,n))return{lat:t,lng:n};var e=n,a=t,r=Math.sqrt(e*e+a*a)+2e-5*Math.sin(a*Math.PI),i=Math.atan2(a,e)+3e-6*Math.cos(e*Math.PI),o=r*Math.cos(i)+.0065,l=r*Math.sin(i)+.006;return{lat:l,lng:o}}function b(t,n){if(c(t,n))return{lat:t,lng:n};var e=n-.0065,a=t-.006,r=Math.sqrt(e*e+a*a)-2e-5*Math.sin(a*Math.PI),i=Math.atan2(a,e)-3e-6*Math.cos(e*Math.PI),o=r*Math.cos(i),l=r*Math.sin(i);return{lat:l,lng:o}}function M(t,n){var e=u(t,n);return p(e.lat,e.lng)}function m(t,n){var e=b(t,n);return h(e.lat,e.lng)}a.wgs2gcj=u,a.gcj2wgs=h,a.gcj2wgs_exact=f,a.distance=d,a.gcj2bd=p,a.bd2gcj=b,a.wgs2bd=M,a.bd2wgs=m;var g=a;a.a_wgs2gcj=function(t){var n=Object(r["a"])(t,2),e=n[0],a=n[1],i=u(a,e);return[i.lng,i.lat]},n["a"]=g}).call(this,e("dd40")(t))},3835:function(t,n,e){"use strict";function a(t){if(Array.isArray(t))return t}e.d(n,"a",(function(){return c}));e("a4d3"),e("e01a"),e("d28b"),e("d3b7"),e("3ca3"),e("ddb0");function r(t,n){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var e=[],a=!0,r=!1,i=void 0;try{for(var o,c=t[Symbol.iterator]();!(a=(o=c.next()).done);a=!0)if(e.push(o.value),n&&e.length===n)break}catch(l){r=!0,i=l}finally{try{a||null==c["return"]||c["return"]()}finally{if(r)throw i}}return e}}var i=e("06c5");function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t,n){return a(t)||r(t,n)||Object(i["a"])(t,n)||o()}},"53ca":function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));e("a4d3"),e("e01a"),e("d28b"),e("d3b7"),e("3ca3"),e("ddb0");function a(t){return a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}},a434:function(t,n,e){"use strict";var a=e("23e7"),r=e("23cb"),i=e("a691"),o=e("50c4"),c=e("7b0b"),l=e("65f0"),s=e("8418"),u=e("1dde"),h=e("ae40"),f=u("splice"),d=h("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,b=Math.min,M=9007199254740991,m="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!f||!d},{splice:function(t,n){var e,a,u,h,f,d,g=c(this),y=o(g.length),v=r(t,y),w=arguments.length;if(0===w?e=a=0:1===w?(e=0,a=y-v):(e=w-2,a=b(p(i(n),0),y-v)),y+e-a>M)throw TypeError(m);for(u=l(g,a),h=0;h<a;h++)f=v+h,f in g&&s(u,h,g[f]);if(u.length=a,e<a){for(h=v;h<y-a;h++)f=h+a,d=h+e,f in g?g[d]=g[f]:delete g[d];for(h=y;h>y-a+e;h--)delete g[h-1]}else if(e>a)for(h=y-a;h>v;h--)f=h+a-1,d=h+e-1,f in g?g[d]=g[f]:delete g[d];for(h=0;h<e;h++)g[h+v]=arguments[h+2];return g.length=y-a+e,u}})},b85c:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));e("a4d3"),e("e01a"),e("d28b"),e("d3b7"),e("3ca3"),e("ddb0");var a=e("06c5");function r(t,n){var e;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=Object(a["a"])(t))||n&&t&&"number"===typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return c=t.done,t},e:function(t){l=!0,o=t},f:function(){try{c||null==e["return"]||e["return"]()}finally{if(l)throw o}}}}},d530:function(t,n,e){"use strict";e.r(n);var a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticStyle:{height:"100%",width:"100%"},attrs:{id:"real-time-map"},on:{dblclick:t.maximize}},[t.channel?t._e():e("div",{staticStyle:{"text-align":"center",height:"100%"}},[t._v("地图组件初始化失败")])])},r=[],i=(e("d81d"),e("fb6a"),e("a434"),e("b85c")),o=e("0f6a"),c={name:"RealTimeMap",props:{cId:{type:String,required:!1}},data:function(){return{channel:null,map:null,mapCenter:null,carMarker:null,lines:[],maxLineCapacity:1e3,lastLocation:null}},created:function(){var t=this,n=this.cId?this.cId:this.$route.params.cid;n&&(this.channel=new BroadcastChannel(n),this.channel.onmessage=function(n){var e=n.data.type,a=n.data.data;t.onChannelMessage(e,a)},this.$nextTick((function(){t.createMap(o["a"]["a_wgs2gcj"]([117.1482253804925,36.69067493933744,0]))})))},methods:{createMap:function(t){if(!this.map){var n=new AMap.Map("real-time-map",{center:t,resizeEnable:!0,layers:[new AMap.TileLayer.Satellite],zoom:20});AMap.plugin(["AMap.MapType","AMap.Geolocation"],(function(){n.addControl(new AMap.MapType),n.addControl(new AMap.Geolocation)})),this.map=n}},onChannelMessage:function(t,n){switch(t){case"location":this.handleLocationMessage(n);break}},handleLocationMessage:function(t){var n=o["a"]["a_wgs2gcj"]([t["lng"],t["lat"]]),e=t["angle"];if(this.map){if(this.mapCenter||(this.mapCenter=n,this.map.setCenter(this.mapCenter)),this.lines.length===this.maxLineCapacity){var a=this.lines.slice(0,this.maxLineCapacity-1);this.lines.splice(0,this.maxLineCapacity);var r,c=Object(i["a"])(a);try{for(c.s();!(r=c.n()).done;){var l=r.value;this.map.remove(l)}}catch(h){c.e(h)}finally{c.f()}}null==this.carMarker&&(this.carMarker=new AMap.Marker({position:n,icon:"https://webapi.amap.com/images/car.png",offset:new AMap.Pixel(-26,-13),autoRotation:!0,angle:-90,title:"作业设备"}),this.map.add(this.carMarker)),this.carMarker.setAngle(e+270),this.lastLocation||(this.lastLocation=n);var s=[this.lastLocation,n],u=new AMap.Polyline({map:this.map,path:s,showDir:!0,strokeColor:"#28F",strokeWeight:6});this.lines.push(u),this.carMarker.moveAlong(s,1e3),this.lastLocation=n}},maximize:function(){window.open("#/expand/map/"+this.cId)}},beforeDestroy:function(){this.channel&&this.channel.close(),this.map&&this.map.destroy()}},l=c,s=e("2877"),u=Object(s["a"])(l,a,r,!1,null,"1f120136",null);n["default"]=u.exports},dd40:function(t,n){t.exports=function(t){if(!t.webpackPolyfill){var n=Object.create(t);n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),Object.defineProperty(n,"exports",{enumerable:!0}),n.webpackPolyfill=1}return n}}}]);